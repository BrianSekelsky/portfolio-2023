---
import SmallHeading from "./SmallHeading.astro";
import { Image } from "astro:assets";

interface Props {
  title: string;
  objective: string;
  types: string[];
  collaborators: string[];
  year: string;
  outboundLink?: string;
  music?: boolean;
  // Hero media props
  heroImage?: ImageMetadata;
  heroVideo?: string;
  heroVideoMp4?: string;
  heroPoster?: string;
  heroAlt?: string;
}
const {
  title,
  objective,
  types,
  collaborators,
  year,
  outboundLink = "",
  music = false,
  heroImage,
  heroVideo,
  heroVideoMp4,
  heroPoster,
  heroAlt = "Project hero image",
} = Astro.props;

const hasHero = heroImage || heroVideo;
---

<div class="site-padding project-header load-in">
  <div class="header-card flex flex-col">
    <!-- Title section -->
    <div class="title-section p-6 sm:p-8">
      <!-- <a
        href="/"
        class="inline-block w-fit font-mono text-sm border rounded-full px-4 py-1 mb-4 hover:bg-verylightgray dark:hover:bg-dark-surface-hover transition-colors back-link"
        >‚Üê Back to projects</a
      > -->
      <h1
        class="font-serif font-extralight text-4xl sm:text-6xl md:text-7xl break-words sm:break-normal hyphens-auto sm:hyphens-manual leading-[1.1]"
      >
        {title}
      </h1>
    </div>

    <!-- Project details bar at bottom -->
    <div class="project-details-bar p-6 sm:p-8 mt-auto">
      <div class="flex flex-wrap gap-6 sm:gap-12">
        <div class="flex-1 min-w-[200px]">
          <SmallHeading text="Overview" />
          <p class="text-sm sm:text-base">{objective}</p>
          <slot />
        </div>
        <div class="flex gap-6 sm:gap-10 flex-wrap">
          <div class={music === false ? "block" : "hidden"}>
            <SmallHeading text="Type" />
            <div class={types.length > 0 ? "block" : "hidden"}>
              {types.map((type) => <p class="text-sm">{type}</p>)}
            </div>
          </div>
          <div class={music === true ? "block" : "hidden"}>
            <SmallHeading text="Genres" />
            <div class={types.length > 0 ? "block" : "hidden"}>
              {types.map((type) => <p class="text-sm">{type}</p>)}
            </div>
          </div>
          <div>
            <SmallHeading text="Year" />
            <p class="text-sm">{year}</p>
          </div>
          <div class={collaborators.length > 0 ? "block" : "hidden"}>
            <SmallHeading text="Collaborators" />
            <div>
              {collaborators.map((collaborator) => (
                <p class="text-sm">{collaborator}</p>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
        <!-- Hero media section -->
    {hasHero && (
      <div class="hero-media">
        {heroVideo ? (
          <video
            playsinline
            autoplay
            muted
            loop
            preload="metadata"
            poster={heroPoster}
            class="w-full h-full object-cover"
          >
            <source src={heroVideo} type="video/webm" />
            {heroVideoMp4 && <source src={heroVideoMp4} type="video/mp4" />}
          </video>
        ) : heroImage ? (
          <Image
            src={heroImage}
            alt={heroAlt}
            class="w-full h-full object-cover"
          />
        ) : null}
      </div>
    )}
  </div>
</div>

<style>
  .back-link {
    border-color: var(--border-color);
  }

  .hero-media {
    width: 100%;
    height: 300px;
    overflow: hidden;
    border-top: 1px solid var(--border-color);
  }

  @media (min-width: 640px) {
    .hero-media {
      height: 400px;
    }
  }

  @media (min-width: 768px) {
    .hero-media {
      height: 600px;
    }
  }

  .title-section {
    /* border-top: 1px solid var(--border-color); */
  }

  .project-details-bar {
    border-top: 1px solid var(--border-color);
    background: rgba(255, 255, 255, 0.5);
  }

  :global(.dark) .project-details-bar {
    background: rgba(10, 10, 26, 0.5);
  }
</style>
